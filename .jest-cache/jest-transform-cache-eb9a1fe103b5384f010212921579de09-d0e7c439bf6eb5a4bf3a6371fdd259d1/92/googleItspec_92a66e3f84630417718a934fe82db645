5ed042191caade40bf60b128b120dc16
"use strict";

jest.mock('child_process', function () {
  return {
    exec: jest.fn(function () {})
  };
});
jest.mock('../src/utils', function () {
  return _objectSpread({}, jest.requireActual('../src/utils'), {
    logIt: jest.fn(function () {})
  });
});

var _child_process = require("child_process");

var _googleIt = require("../src/googleIt");

var _utils = require("../src/utils");

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

global.console = {
  log: jest.fn()
};
describe('errorTryingToOpen', function () {
  it('does not call console.log when error is falsy', function () {
    console.log.mockClear();
    (0, _googleIt.errorTryingToOpen)(false);
    expect(console.log).not.toHaveBeenCalled();
  });
  it('calls console.log 3 times when error is true', function () {
    console.log.mockClear();
    (0, _googleIt.errorTryingToOpen)('something really bad', 'stdout', 'stderr');
    expect(console.log).toHaveBeenCalledTimes(3);
  });
});
describe('openInBrowser', function () {
  it('does not call exec when "open" is undefined', function () {
    _child_process.exec.mockClear();

    (0, _googleIt.openInBrowser)(undefined);
    expect(_child_process.exec).not.toHaveBeenCalled();
  });
  it('calls exec results.slice(0, open).length times when "open" is > 0', function () {
    _child_process.exec.mockClear();

    (0, _googleIt.openInBrowser)(3, [{
      link: ''
    }, {
      link: ''
    }, {
      link: ''
    }]);
    expect(_child_process.exec).toHaveBeenCalledTimes(3);
  });
});
describe('getSnippet', function () {
  it('maps over elem.children and data field, joined by empty string', function () {
    var result = (0, _googleIt.getSnippet)({
      children: [{
        data: '1'
      }, {
        data: '2'
      }, {
        data: '3'
      }]
    });
    expect(result).toBe('123');
  });
  it('returns child.children.map(c => c.data) when child.data does not exist', function () {
    var result = (0, _googleIt.getSnippet)({
      children: [{
        children: [{
          data: '1'
        }]
      }, {
        children: [{
          data: '2'
        }]
      }, {
        children: [{
          data: '3'
        }]
      }]
    });
    expect(result).toBe('123');
  });
});
describe('display', function () {
  it('calls logIt once for each result (+ once for newline) when 3rd arg (onlyUrls) is true', function () {
    _utils.logIt.mockClear();

    (0, _googleIt.display)([{
      link: 'a'
    }, {
      link: 'b'
    }], false, true);
    expect(_utils.logIt).toHaveBeenCalledTimes(3);
  });
  it('calls logIt 4 times for each result (+ once for newline) when 3rd arg is false', function () {
    _utils.logIt.mockClear();

    (0, _googleIt.display)([{
      title: 'a',
      link: 'a',
      snippet: 'a'
    }, {
      title: 'b',
      link: 'b',
      snippet: 'b'
    }], false, false);
    expect(_utils.logIt).toHaveBeenCalledTimes(9);
  });
  it('calls logIt once for each result (+ once for newline) when 3rd arg (onlyUrls) is false but title is missing', function () {
    _utils.logIt.mockClear();

    (0, _googleIt.display)([{
      link: 'a',
      snippet: 'a'
    }, {
      link: 'b',
      snippet: 'b'
    }], false, false);
    expect(_utils.logIt).toHaveBeenCalledTimes(3);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdvb2dsZUl0LnNwZWMuanMiXSwibmFtZXMiOlsiamVzdCIsIm1vY2siLCJleGVjIiwiZm4iLCJyZXF1aXJlQWN0dWFsIiwibG9nSXQiLCJnbG9iYWwiLCJjb25zb2xlIiwibG9nIiwiZGVzY3JpYmUiLCJpdCIsIm1vY2tDbGVhciIsImV4cGVjdCIsIm5vdCIsInRvSGF2ZUJlZW5DYWxsZWQiLCJ0b0hhdmVCZWVuQ2FsbGVkVGltZXMiLCJ1bmRlZmluZWQiLCJsaW5rIiwicmVzdWx0IiwiY2hpbGRyZW4iLCJkYXRhIiwidG9CZSIsInRpdGxlIiwic25pcHBldCJdLCJtYXBwaW5ncyI6Ijs7QUFnQkFBLElBQUksQ0FBQ0MsSUFBTCxDQUFVLGVBQVYsRUFBMkI7QUFBQSxTQUFPO0FBQ2hDQyxJQUFBQSxJQUFJLEVBQUVGLElBQUksQ0FBQ0csRUFBTCxDQUFRLFlBQU0sQ0FBRSxDQUFoQjtBQUQwQixHQUFQO0FBQUEsQ0FBM0I7QUFJQUgsSUFBSSxDQUFDQyxJQUFMLENBQVUsY0FBVixFQUEwQjtBQUFBLDJCQUNyQkQsSUFBSSxDQUFDSSxhQUFMLENBQW1CLGNBQW5CLENBRHFCO0FBRXhCQyxJQUFBQSxLQUFLLEVBQUVMLElBQUksQ0FBQ0csRUFBTCxDQUFRLFlBQU0sQ0FBRSxDQUFoQjtBQUZpQjtBQUFBLENBQTFCOztBQW5CQTs7QUFDQTs7QUFRQTs7Ozs7Ozs7QUFFQUcsTUFBTSxDQUFDQyxPQUFQLEdBQWlCO0FBQ2ZDLEVBQUFBLEdBQUcsRUFBRVIsSUFBSSxDQUFDRyxFQUFMO0FBRFUsQ0FBakI7QUFhQU0sUUFBUSxDQUFDLG1CQUFELEVBQXNCLFlBQU07QUFDbENDLEVBQUFBLEVBQUUsQ0FBQywrQ0FBRCxFQUFrRCxZQUFNO0FBQ3hESCxJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUcsU0FBWjtBQUNBLHFDQUFrQixLQUFsQjtBQUNBQyxJQUFBQSxNQUFNLENBQUNMLE9BQU8sQ0FBQ0MsR0FBVCxDQUFOLENBQW9CSyxHQUFwQixDQUF3QkMsZ0JBQXhC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O0FBQUVXLE1BQUFBLEtBQUssRUFBRSxHQUFUO0FBQWNMLE1BQUFBLElBQUksRUFBRSxHQUFwQjtBQUF5Qk0sTUFBQUEsT0FBTyxFQUFFO0FBQWxDLEtBRE0sRUFFTjtBQUFFRCxNQUFBQSxLQUFLLEVBQUUsR0FBVDtBQUFjTCxNQUFBQSxJQUFJLEVBQUUsR0FBcEI7QUFBeUJNLE1BQUFBLE9BQU8sRUFBRTtBQUFsQyxLQUZNLENBQVIsRUFHRyxLQUhILEVBR1UsS0FIVjtBQUlBWCxJQUFBQSxNQUFNLENBQUNQLFlBQUQsQ0FBTixDQUFjVSxxQkFBZCxDQUFvQyxDQUFwQztBQUNELEdBUEMsQ0FBRjtBQVNBTCxFQUFBQSxFQUFFLENBQUMsNkdBQUQsRUFBZ0gsWUFBTTtBQUN0SEwsaUJBQU1NLFNBQU47O0FBQ0EsMkJBQVEsQ0FDTjtBQUFFTSxNQUFBQSxJQUFJLEVBQUUsR0FBUjtBQUFhTSxNQUFBQSxPQUFPLEVBQUU7QUFBdEIsS0FETSxFQUVOO0FBQUVOLE1BQUFBLElBQUksRUFBRSxHQUFSO0FBQWFNLE1BQUFBLE9BQU8sRUFBRTtBQUF0QixLQUZNLENBQVIsRUFHRyxLQUhILEVBR1UsS0FIVjtBQUlBWCxJQUFBQSxNQUFNLENBQUNQLFlBQUQsQ0FBTixDQUFjVSxxQkFBZCxDQUFvQyxDQUFwQztBQUNELEdBUEMsQ0FBRjtBQVFELENBeEJPLENBQVIiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBuby1jb25zb2xlICovXG5pbXBvcnQgeyBleGVjIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQge1xuICBlcnJvclRyeWluZ1RvT3BlbixcbiAgb3BlbkluQnJvd3NlcixcbiAgZ2V0U25pcHBldCxcbiAgZGlzcGxheSxcbiAgLy8gZ2V0UmVzdWx0cyxcbiAgLy8gZ2V0UmVzcG9uc2VCb2R5LFxufSBmcm9tICcuLi9zcmMvZ29vZ2xlSXQnO1xuaW1wb3J0IHsgbG9nSXQgfSBmcm9tICcuLi9zcmMvdXRpbHMnO1xuXG5nbG9iYWwuY29uc29sZSA9IHtcbiAgbG9nOiBqZXN0LmZuKCksXG59O1xuXG5qZXN0Lm1vY2soJ2NoaWxkX3Byb2Nlc3MnLCAoKSA9PiAoe1xuICBleGVjOiBqZXN0LmZuKCgpID0+IHt9KSxcbn0pKTtcblxuamVzdC5tb2NrKCcuLi9zcmMvdXRpbHMnLCAoKSA9PiAoe1xuICAuLi5qZXN0LnJlcXVpcmVBY3R1YWwoJy4uL3NyYy91dGlscycpLFxuICBsb2dJdDogamVzdC5mbigoKSA9PiB7fSksXG59KSk7XG5cbmRlc2NyaWJlKCdlcnJvclRyeWluZ1RvT3BlbicsICgpID0+IHtcbiAgaXQoJ2RvZXMgbm90IGNhbGwgY29uc29sZS5sb2cgd2hlbiBlcnJvciBpcyBmYWxzeScsICgpID0+IHtcbiAgICBjb25zb2xlLmxvZy5tb2NrQ2xlYXIoKTtcbiAgICBlcnJvclRyeWluZ1RvT3BlbihmYWxzZSk7XG4gICAgZXhwZWN0KGNvbnNvbGUubG9nKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICB9KTtcblxuICBpdCgnY2FsbHMgY29uc29sZS5sb2cgMyB0aW1lcyB3aGVuIGVycm9yIGlzIHRydWUnLCAoKSA9PiB7XG4gICAgY29uc29sZS5sb2cubW9ja0NsZWFyKCk7XG4gICAgZXJyb3JUcnlpbmdUb09wZW4oJ3NvbWV0aGluZyByZWFsbHkgYmFkJywgJ3N0ZG91dCcsICdzdGRlcnInKTtcbiAgICBleHBlY3QoY29uc29sZS5sb2cpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygzKTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ29wZW5JbkJyb3dzZXInLCAoKSA9PiB7XG4gIGl0KCdkb2VzIG5vdCBjYWxsIGV4ZWMgd2hlbiBcIm9wZW5cIiBpcyB1bmRlZmluZWQnLCAoKSA9PiB7XG4gICAgZXhlYy5tb2NrQ2xlYXIoKTtcbiAgICBvcGVuSW5Ccm93c2VyKHVuZGVmaW5lZCk7XG4gICAgZXhwZWN0KGV4ZWMpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gIH0pO1xuXG4gIGl0KCdjYWxscyBleGVjIHJlc3VsdHMuc2xpY2UoMCwgb3BlbikubGVuZ3RoIHRpbWVzIHdoZW4gXCJvcGVuXCIgaXMgPiAwJywgKCkgPT4ge1xuICAgIGV4ZWMubW9ja0NsZWFyKCk7XG4gICAgb3BlbkluQnJvd3NlcigzLCBbeyBsaW5rOiAnJyB9LCB7IGxpbms6ICcnIH0sIHsgbGluazogJycgfV0pO1xuICAgIGV4cGVjdChleGVjKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMyk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdnZXRTbmlwcGV0JywgKCkgPT4ge1xuICBpdCgnbWFwcyBvdmVyIGVsZW0uY2hpbGRyZW4gYW5kIGRhdGEgZmllbGQsIGpvaW5lZCBieSBlbXB0eSBzdHJpbmcnLCAoKSA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gZ2V0U25pcHBldCh7XG4gICAgICBjaGlsZHJlbjogW3sgZGF0YTogJzEnIH0sIHsgZGF0YTogJzInIH0sIHsgZGF0YTogJzMnIH1dLFxuICAgIH0pO1xuICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJzEyMycpO1xuICB9KTtcblxuICBpdCgncmV0dXJucyBjaGlsZC5jaGlsZHJlbi5tYXAoYyA9PiBjLmRhdGEpIHdoZW4gY2hpbGQuZGF0YSBkb2VzIG5vdCBleGlzdCcsICgpID0+IHtcbiAgICBjb25zdCByZXN1bHQgPSBnZXRTbmlwcGV0KHtcbiAgICAgIGNoaWxkcmVuOiBbXG4gICAgICAgIHsgY2hpbGRyZW46IFt7IGRhdGE6ICcxJyB9XSB9LFxuICAgICAgICB7IGNoaWxkcmVuOiBbeyBkYXRhOiAnMicgfV0gfSxcbiAgICAgICAgeyBjaGlsZHJlbjogW3sgZGF0YTogJzMnIH1dIH0sXG4gICAgICBdLFxuICAgIH0pO1xuICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoJzEyMycpO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnZGlzcGxheScsICgpID0+IHtcbiAgaXQoJ2NhbGxzIGxvZ0l0IG9uY2UgZm9yIGVhY2ggcmVzdWx0ICgrIG9uY2UgZm9yIG5ld2xpbmUpIHdoZW4gM3JkIGFyZyAob25seVVybHMpIGlzIHRydWUnLCAoKSA9PiB7XG4gICAgbG9nSXQubW9ja0NsZWFyKCk7XG4gICAgZGlzcGxheShbeyBsaW5rOiAnYScgfSwgeyBsaW5rOiAnYicgfV0sIGZhbHNlLCB0cnVlKTtcbiAgICBleHBlY3QobG9nSXQpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygzKTtcbiAgfSk7XG5cbiAgaXQoJ2NhbGxzIGxvZ0l0IDQgdGltZXMgZm9yIGVhY2ggcmVzdWx0ICgrIG9uY2UgZm9yIG5ld2xpbmUpIHdoZW4gM3JkIGFyZyBpcyBmYWxzZScsICgpID0+IHtcbiAgICBsb2dJdC5tb2NrQ2xlYXIoKTtcbiAgICBkaXNwbGF5KFtcbiAgICAgIHsgdGl0bGU6ICdhJywgbGluazogJ2EnLCBzbmlwcGV0OiAnYScgfSxcbiAgICAgIHsgdGl0bGU6ICdiJywgbGluazogJ2InLCBzbmlwcGV0OiAnYicgfSxcbiAgICBdLCBmYWxzZSwgZmFsc2UpO1xuICAgIGV4cGVjdChsb2dJdCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDkpO1xuICB9KTtcblxuICBpdCgnY2FsbHMgbG9nSXQgb25jZSBmb3IgZWFjaCByZXN1bHQgKCsgb25jZSBmb3IgbmV3bGluZSkgd2hlbiAzcmQgYXJnIChvbmx5VXJscykgaXMgZmFsc2UgYnV0IHRpdGxlIGlzIG1pc3NpbmcnLCAoKSA9PiB7XG4gICAgbG9nSXQubW9ja0NsZWFyKCk7XG4gICAgZGlzcGxheShbXG4gICAgICB7IGxpbms6ICdhJywgc25pcHBldDogJ2EnIH0sXG4gICAgICB7IGxpbms6ICdiJywgc25pcHBldDogJ2InIH0sXG4gICAgXSwgZmFsc2UsIGZhbHNlKTtcbiAgICBleHBlY3QobG9nSXQpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygzKTtcbiAgfSk7XG59KTtcbiJdfQ==